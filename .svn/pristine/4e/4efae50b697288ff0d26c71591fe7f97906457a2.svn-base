class WinnersController < ApplicationController

  before_filter :authenticate_admin!

  def list
    @tenders = Tender.all
  end

  def new
    @tender = Tender.find(params[:tender_id])
    @stones = @tender.stones
    if @tender.winners.blank?
      render 'new'
    else
      render 'winners_list'
    end
  end

  def save
    @winner_attr = params['winner']
    @winner_attr.each do |k, winner_attr|
      unless winner_attr['bid_id'].blank?
        Winner.create(winner_attr)
      end
    end
    redirect_to new_winner_path(:tender_id => params[:tender_id])
  end

end


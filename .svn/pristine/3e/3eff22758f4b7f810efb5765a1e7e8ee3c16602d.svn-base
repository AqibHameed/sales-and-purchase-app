<link rel="stylesheet" media="all" type="text/css" href="http://code.jquery.com/ui/1.10.2/themes/redmond/jquery-ui.css" />

<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.min.js"></script>
<script type="text/javascript" src="http://code.jquery.com/ui/1.10.2/jquery-ui.min.js"></script>

<%= form_tag(post_url, :method => search_method, :remote => true) do %>
  <div class="form-wrapper">

    <div class="form-row">
      <div class="label">Name of Tender</div>
      <div class="field">
        <%= text_field_tag 'search[name]', '', :class => 'input' %>
      </div>
      <div class="clear"></div>
    </div>

    <div class="form-row">
      <div class="label">Year / Period</div>
      <div class="field">
        <div>
          <span>
            <%= text_field_tag 'search[start_date]', '', :class => 'date' %>
            <!-- <input type="text" class="date"> -->
            <a class="calendar" href="#">Calendar</a>
          </span>
          <span>
            <%= text_field_tag 'search[end_date]', '', :class => 'date' %>
            <!-- <input type="text" class="date"> -->
            <a class="calendar" href="#">Calendar</a>
            Date Range
          </span>
        </div>
        <div class="clear10"></div>
        <div>
          <span>
            <%= text_field_tag 'search[specific_date]', '', :class => 'date' %>
            <!-- <input type="text" class="date"> -->
            <a class="calendar" href="#">Calendar</a>
            Specific Date
          </span>
        </div>
      </div>
      <div class="clear"></div>
    </div>

    <div class="form-row">
    	<div class="label">Type</div>
      <div class="field">
        <%= select_tag 'search[type]', options_for_select(['Parcel', 'Stone']), :class => 'select type_select', :include_blank => true %>
      </div>
      <div class="clear"></div>
    </div>

    <% if current_admin %>
    <div class="form-row">
      <div class="label">Customer</div>
      <div class="field">
        <%= select_tag 'search[customer_id]', options_for_select( Customer.all.map{|c| [c.name, c.id] }), :class => 'select', :include_blank => true %>
      </div>
      <div class="clear"></div>
    </div>
    <% end %>
    <div class="clear10"></div>

  	<h2>Aditional Search</h2>
    <div class="clear10"></div>

    <div class='parcel_search'>
      <div class="form-row">
    	  <div class="label">Description</div>
        <div class="field">
        	<%= select_tag 'search[description]', options_for_select(['']), :class => 'select parcel_fields', :include_blank => true %>
        </div>
        <div class="clear"></div>
      </div>

      <div class="form-row">
      	<div class="label">Size</div>
        <div class="field">
        	<%= select_tag 'search[size]', options_for_select( (1..10).to_a ), :class => 'select parcel_fields', :include_blank => true %>
        </div>
        <div class="clear"></div>
      </div>
    </div>

    <div class='stone_search' style='display:none;'>
      <div class="form-row">
    	  <div class="label">Carat</div>
        <div class="field">
        	<%= select_tag 'search[carat]', options_for_select( (18..24).to_a ), :class => 'select stone_fields', :include_blank => true %>
        </div>
        <div class="clear"></div>
      </div>

      <div class="form-row">
      	<div class="label">Color</div>
        <div class="field">
        	<%= select_tag 'search[color]', options_for_select( ['White', 'Silver']), :class => 'select stone_fields', :include_blank => true %>
        </div>
        <div class="clear"></div>
      </div>

      <div class="form-row">
      	<div class="label">Purity</div>
        <div class="field">
        	<%= select_tag 'search[purity]', options_for_select( [25, 50, 75, 100] ), :class => 'select stone_fields', :include_blank => true %>
        </div>
        <div class="clear"></div>
      </div>
    </div>

    <div class="form-row">
      <div class="label">&nbsp;</div>
      <div class="field">
        <%= submit_tag 'Search', :class => 'btn-01' %>
        <!-- <a href="#" class="btn-01">Search</a> -->
      </div>
      <div class="clear"></div>
    </div>
  </div>
<% end %>

<script>
  $(document).ready(function(){
    $('.date').datepicker({
      dateFormat : 'dd-mm-yy',
    })

    $(document).on('click', '.calendar', function(){
      //alert('called')
      $(this).parent('span').find('.date').focus()
    })

    toggleAdditionalSearch($('.type_select'));

    $(document).on('change', '.type_select', function(){
      toggleAdditionalSearch($(this));
    })
  })

  function toggleAdditionalSearch(selector){
    if( $(selector).val() == '' ){
      $('.stone_search').hide();
      $('.parcel_search').hide();
      $('.stone_fields').attr('disabled', 'disabled')
      $('.parcel_fields').attr('disabled', 'disabled')
    } else {
      if( $(selector).val() == 'Parcel'){
        $('.parcel_search').show();
        $('.stone_search').hide();
        $('.parcel_fields').removeAttr('disabled')
        $('.stone_fields').attr('disabled', 'disabled')
      } else{
        if( $(selector).val() == 'Stone'){
          $('.stone_search').show();
          $('.parcel_search').hide();
          $('.stone_fields').removeAttr('disabled')
          $('.parcel_fields').attr('disabled', 'disabled')
        }
      }
    }
  }
</script>

